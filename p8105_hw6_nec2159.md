p8105_hw6_nec2159
================
Nicole Criscuolo
2025-11-18

## Problem 2

``` r
data("weather_df")

estimates =
weather_df |> 
  modelr::bootstrap(n = 500) |> 
  mutate(
    models = map(strap, \(df) lm(tmax ~ tmin + prcp, data = df)),
    tidy_results = map(models, broom::tidy),
    glance_results = map(models, broom::glance),
    beta_ratio = map_dbl(tidy_results, \(x) x[["estimate"]][2] / x[["estimate"]][3]),
    r_squared = map_dbl(glance_results, "r.squared")
    ) |> 
  select(.id, beta_ratio, r_squared)
```

``` r
estimates |> 
  ggplot(aes(x = beta_ratio)) +
  geom_histogram(fill = "lavender", color = "purple") +
  labs(
    title = "Bootstrap Distribution of Beta Ratio"
  )
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

<img src="p8105_hw6_nec2159_files/figure-gfm/unnamed-chunk-2-1.png" width="90%" />

``` r
estimates |> 
  ggplot(aes(x = r_squared)) +
  geom_histogram(fill = "lavender", color = "purple") +
  labs(
    title = "Bootstrap Distribution of R Squared"
  )
```

    ## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.

<img src="p8105_hw6_nec2159_files/figure-gfm/unnamed-chunk-3-1.png" width="90%" />

The distribution of $\frac{\hat{\beta}_1}{\hat{\beta}_2}$ appears to be
left-skewed.

``` r
beta_ratio_CI =
estimates |> 
  pull(beta_ratio) |> 
  quantile(c(.025, .975))
```

The distribution of $R^2$ appears to be normally distributed.

``` r
estimates |> 
  pull(r_squared) |> 
  quantile(c(.025, .975))
```

    ##      2.5%     97.5% 
    ## 0.9349784 0.9464825
